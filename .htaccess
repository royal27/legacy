<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Prevent direct access to certain directories
    RewriteRule ^(core|plugins|themes)/ - [F,L]

    # Allow access to the install folder only if config.php does not exist
    RewriteCond %{REQUEST_URI} !^/install/.*$
    RewriteCond %{DOCUMENT_ROOT}/config.php -f
    RewriteRule ^install/ - [F,L]

    # Main routing rule
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?q=$1 [L,QSA]
</IfModule>
